name: "Apply VIPC Dependencies"
description: "Runs ApplyVIPC.ps1 to install runner dependencies for a given LabVIEW version/bitness."
runs:
  using: "composite"
  steps:
    - name: Checkout code
      uses: actions/checkout@v3
      with:
        fetch-depth: 0

    - name: Run ApplyVIPC.ps1
      shell: pwsh
      run: |
        & "${{ github.action_path }}/ApplyVIPC.ps1" `
          -MinimumSupportedLVVersion ${{ inputs.minimum_supported_lv_version }} `
          -VIP_LVVersion ${{ inputs.vip_lv_version }} `
          -SupportedBitness ${{ inputs.supported_bitness }} `
          -RelativePath "${{ inputs.relative_path }}" `
          -VIPCPath "${{ inputs.vipc_path }}" `
          -DisplayOnly:(${{ inputs.display_only }} -eq 'true')
inputs:
  minimum_supported_lv_version:
    description: 'LabVIEW major version (e.g. 2021)'
    required: true
  vip_lv_version:
    description: 'VIPC LV version (usually same as minimum supported)'
    required: true
  supported_bitness:
    description: '32 or 64'
    required: true
  relative_path:
    description: 'Workspace root path'
    required: true
  vipc_path:
    description: 'Path to the VIPC file (optional when display_only=true)'
    required: false
    default: ''
  display_only:
    description: 'Set to true to only display installed packages (no install).'
    required: false
    default: 'false'
